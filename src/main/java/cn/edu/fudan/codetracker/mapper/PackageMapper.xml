<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.fudan.codetracker.mapper.PackageMapper">

    <!--column 对应数据库中的字段，property 对应pojo中的属性-->
<!--    <resultMap id="package" type="PackageInfo">
        <id property="uuid" column="uuid"/>
        <collection property="issueType" column="type"
                    select="cn.edu.fudan.issueservice.mapper.IssueTypeMapper.getIssueTypeByTypeName"/>
    </resultMap>

    <resultMap id="rawPackage" type="PackageInfo">
        <id property="uuid" column="uuid"/>
        <collection property="issueType" column="type"
                    select="cn.edu.fudan.issueservice.mapper.IssueTypeMapper.getIssueTypeByTypeName"/>
    </resultMap>-->

    <insert id="insertPackageInfoList" parameterType="List">
        insert into track_package
        (
        uuid,
        package_name,
        module_name,
        start_commit,
        start_commit_date,
        end_commit,
        end_commit_date,
        repo_uuid,
        branch
        )
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (
            #{item.uuid},
            #{item.packageName},
            #{item.moduleName},
            #{item.commonInfo.startCommit},
            #{item.commonInfo.startCommitDate},
            #{item.commonInfo.endCommit},
            #{item.commonInfo.endCommitDate},
            #{item.commonInfo.repoUuid},
            #{item.commonInfo.branch}
            )
        </foreach>
    </insert>

    <insert id="insertRawPackageInfoList" parameterType="List">
        insert into raw_package
        (
        uuid,
        root_uuid,
        version,
        change_relation,
        commitid,
        committer,
        commit_date,
        commit_message,
        parent_commit
        )
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (
            #{item.uuid},
            #{item.trackerInfo.rootUUID},
            #{item.trackerInfo.version},
            #{item.trackerInfo.changeRelation},
            #{item.commonInfo.commit},
            #{item.commonInfo.committer},
            #{item.commonInfo.commitDate},
            #{item.commonInfo.commitMessage},
            #{item.commonInfo.parentCommit}
            )
        </foreach>
    </insert>

</mapper>